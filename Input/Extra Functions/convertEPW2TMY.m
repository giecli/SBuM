function TMYStruct = convertEPW2TMY(EPWStructure)

TMYStruct.SiteID          = [] ;
TMYStruct.StationName     = EPWStructure.station_name    ;
TMYStruct.StationState    = EPWStructure.station_state   ; 
TMYStruct.SiteTimeZone    = EPWStructure.site_TimeZone   ;
TMYStruct.SiteLatitude    = EPWStructure.site_latitude   ;
TMYStruct.SiteLongitude   = EPWStructure.site_longitude  ;
TMYStruct.SiteElevation   = EPWStructure.site_elevation  ;

%% Time conversion

TMYStruct.DateString    = datestr(EPWStructure.date, 'mm/dd/yyyy')   ;
TMYStruct.TimeString    = datestr(EPWStructure.date, 'HH:MM')   ;
TMYStruct.DateNumber    = EPWStructure.date ;
TMYStruct.ETR           = EPWStructure.Extraterrestrial_Horizontal_Radiation ;
TMYStruct.ETRN          = EPWStructure.Extraterrestrial_Direct_Normal_Radiation;
TMYStruct.GHI           = EPWStructure.Global_Horizontal_Radiation ;
TMYStruct.GHISource     = [] ; 
TMYStruct.GHIUncertainty= [] ;
TMYStruct.DNI           = EPWStructure.Direct_Normal_Radiation;
TMYStruct.DNISource     = [];
TMYStruct.DNIUncertainty= [];
TMYStruct.DHI           = EPWStructure.Diffuse_Horizontal_Radiation ;
TMYStruct.DHISource     = [];
TMYStruct.DHIUncertainty= [];
TMYStruct.GHillum       = EPWStructure.Global_Horizontal_Illuminance ;
TMYStruct.GHillumSource = [] ;
TMYStruct.GHillumUncertainty = [];
TMYStruct.DNillum       = EPWStructure.Direct_Normal_Illuminance;
TMYStruct.DNillumSource = [];
TMYStruct.DNillumUncertainty = [];
TMYStruct.DHillum       = EPWStructure.Diffuse_Horizontal_Illuminance;
TMYStruct.DHillumSource = [];
TMYStruct.DHillumUncertainty = [];
TMYStruct.Zenithlum     = EPWStructure.Zenith_Luminance;
TMYStruct.ZenithlumSource = [];
TMYStruct.ZenithlumUncertainty = [];
TMYStruct.TotCld        = EPWStructure.Total_Sky_Cover;
TMYStruct.TotCldSource  = [];
TMYStruct.TotCldUnertainty = [];
TMYStruct.OpqCld        = EPWStructure.Opaque_Sky_Cover;
TMYStruct.OpqCldSource  = [];
TMYStruct.OpqCldUncertainty = [];
TMYStruct.DryBulb       = EPWStructure.Dry_Bulb_Temperature;
TMYStruct.DryBulbSource = [];
TMYStruct.DryBulbUncertainty = [];
TMYStruct.DewPoint      = EPWStructure.Dew_Point_Temperature;
TMYStruct.DewPointSource = [];
TMYStruct.DewPointUncertainty = [];
TMYStruct.RHum          = EPWStructure.Relative_Humidity;
TMYStruct.RHumSource    = [];
TMYStruct.RHumUncertainty = [];
TMYStruct.Pressure      = EPWStructure.Atmospheric_Station_Pressure / 100; % The EPW file is in Pa and the TMY file is in mbar, conversion is necessary
TMYStruct.PressureSource= [];
TMYStruct.PressureUncertainty = [];
TMYStruct.Wdir          = EPWStructure.Wind_Direction;
TMYStruct.WdirSource    = [];
TMYStruct.WdirUncertainty = [];
TMYStruct.Wspd          = EPWStructure.Wind_Speed;
TMYStruct.WspdSource    = [];
TMYStruct.WspdUncertainty = [];
TMYStruct.Hvis          = EPWStructure.Visibility;
TMYStruct.HvisSource    = [];
TMYStruct.HvisUncertainty = [];
TMYStruct.CeilHgt       = EPWStructure.Ceiling_Height;
TMYStruct.CeilHgtSource = [];
TMYStruct.CeilHgtUncertainty = [];
TMYStruct.Pwat          = [];
TMYStruct.PwatSource    = [];
TMYStruct.PwatUncertainty = [];
TMYStruct.AOD           = EPWStructure.Aerosol_Optical_Depth;
TMYStruct.AODSource     = [];
TMYStruct.AODUncertainty = [];
TMYStruct.Alb           = EPWStructure.Albedo ;
TMYStruct.AlbSource     = [];
TMYStruct.AlbUncertainty = [];
TMYStruct.Lprecipdepth  = EPWStructure.Liquid_Precipitation_Depth;
TMYStruct.Lprecipquantity = EPWStructure.Liquid_Precipitation_Quantity;
TMYStruct.LprecipSource = [];
TMYStruct.LprecipUncertainty = [];
TMYStruct.PresWth       = EPWStructure.Present_Weather_Codes;
TMYStruct.PresWthSource = [];
TMYStruct.PresWthUncertainty = [];